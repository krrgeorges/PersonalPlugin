hosts = ["linkedin.com","github.com"]

var old_ll_ss = ["https://static-exp1.licdn.com/sc/h/br/zfa70dr0xahr65p72dyuh2iq", "https://static-exp1.licdn.com/sc/h/br/144dygk0mpvy8dmfd0ab3guw2", "https://static-exp1.licdn.com/sc/h/br/784awsl7p8v39gae3szngzqpc", "https://static-exp1.licdn.com/sc/h/br/atutc04ofkoqcu4o2ihbsh5ti", "https://static-exp1.licdn.com/sc/h/br/7hac4jjj1ty9tqbswq46h2sed", "https://static-exp1.licdn.com/sc/h/br/4t43daj0en1j4fq745ehqqx3o", "https://static-exp1.licdn.com/sc/h/br/eoinzopz5vzximh9bxh4ou3ec", "https://static-exp1.licdn.com/sc/h/br/10ng5dj36b7muycly0rgu8xxt", "https://static-exp1.licdn.com/sc/h/br/6qy38w0ghcdow4ewegmxoor1b", "https://static-exp1.licdn.com/sc/h/br/8p5n9z2umb2colc2pimdy02c6", "https://static-exp1.licdn.com/sc/h/br/3xemm7ckiw16y6ytp0yprj61d", "https://static-exp1.licdn.com/sc/h/br/4ude7ry71hld55ckzemowgw5c", "https://static-exp1.licdn.com/sc/h/br/1eusa9u1l6npjjusyzdojji50", "https://static-exp1.licdn.com/sc/h/br/2xutddnvxwl9prma16xx4gk5e", "https://static-exp1.licdn.com/sc/h/br/ecg34at02131p39kunrt7bwxm", "https://static-exp1.licdn.com/sc/h/br/2oan33dtjl5iyc3kzzts8gkty", "https://static-exp1.licdn.com/sc/h/br/73nnl3n5ffp1heneyn8bpjt2z", "https://static-exp1.licdn.com/sc/h/br/bi3jmvaduc3iowkr8iutrq0bi", "https://static-exp1.licdn.com/sc/h/br/3gcs6yta8i26gb7vuuibq3oj9", "data:text/css;charset=utf-8;base64,QGNoYXJzZXQgICAâ€¦gICAgICBtYXJnaW4tbGVmdDogIDEwNXB4OwogICAgICAgfSA=", "https://static-exp1.licdn.com/sc/h/br/7zoioh3hzc76n91id19tp5p6p", "https://static-exp1.licdn.com/sc/h/br/880lbfepv3tliohrq7v73swby", "https://static-exp1.licdn.com/sc/h/br/7o3oto5yr3mkurtj4myt9wjiv", "https://static-exp1.licdn.com/sc/h/br/5utrhz2tcfc09sym2mrterh3q", "https://static-exp1.licdn.com/sc/h/br/4cauav0qxbky6by9aavsndhyz", "https://static-exp1.licdn.com/sc/h/br/4eurwbn980liykqwun156zkzq", "https://static-exp1.licdn.com/sc/h/br/55e7wqtub3tqffwv77pqg3p3l"]
var old_ll_js = [["https://platform.linkedin.com/litms/vendor/google/gtag-adwords.js?id=AW-867846157","text/javascript"],["https://platform.linkedin.com/js/analytics.js",""],["","application/javascript"],["https://static-exp1.licdn.com/sc/h/br/40nkwms0jpasv7yh3fxgj2zju",""],["https://static-exp1.licdn.com/sc/h/br/4h83hduf4oo0s0zbc04trlbhq",""],["https://static-exp1.licdn.com/sc/h/br/ci1xr0ddl1k1zkhnzv7qp4ynf",""],["https://static-exp1.licdn.com/sc/h/br/84xf15h2rup5sqqh7f0rr970t",""],["https://static-exp1.licdn.com/sc/h/br/9np5v85kti7wfwsrcqh2pgpc1",""],["https://static-exp1.licdn.com/sc/h/br/4oeiudlcvpiishds2fbyff6xy",""],["https://static-exp1.licdn.com/sc/h/br/4fca0rw9m2k3vbwx8kq2zmiue",""],["https://static-exp1.licdn.com/sc/h/br/camr3uab8z2et4nj2mblxafb2",""],["https://static-exp1.licdn.com/sc/h/br/10eea3ipflhgxf9r9gqqy29ld",""],["https://static-exp1.licdn.com/sc/h/br/9nblzu6rofyizrk18vuuu2ms5",""],["https://static-exp1.licdn.com/sc/h/br/7j9zglhx8ut39z2yi35zkb1oe",""],["https://static-exp1.licdn.com/sc/h/br/8cdy8w8l6bd1o8a4g0jiwyuw8",""],["https://static-exp1.licdn.com/sc/h/br/11kf1aozyl0teww4vkmt9wd65",""],["https://static-exp1.licdn.com/sc/h/br/coa7f3ykpl4n59lxspa6n42h5",""],["https://static-exp1.licdn.com/sc/h/br/e10piz34e4rybecba7ht33vzz",""],["https://static-exp1.licdn.com/sc/h/br/aoqdl7juodon8gbr6ou2273l7",""],["https://static-exp1.licdn.com/sc/h/br/1k3cmoe6tr7hyq64aaq7lu0sj",""],["https://static-exp1.licdn.com/sc/h/br/1sreld711wp7gtpiu03wvcd1k",""],["https://static-exp1.licdn.com/sc/h/br/bq482m4iexs2t2bvyc169h15g",""],["https://static-exp1.licdn.com/sc/h/br/7iquqtodkwjsyrpjc8kumhpvb",""],["https://static-exp1.licdn.com/sc/h/br/7nj10tlbxxa8hy73qtw7g4x0i",""],["https://static-exp1.licdn.com/sc/h/br/enis1ncj701lj8r1evpoo0o6q",""],["https://platform.linkedin.com/litms/utag/voyager-web-feed/utag.js?cb=1605072300000","text/javascript"],["file://platform.linkedin.com/litms/utag/voyager-web-feed/utag.121.js?utv=ut4.46.202009172011","text/javascript"],["file://platform.linkedin.com/litms/utag/voyager-web-feed/utag.128.js?utv=ut4.46.202009172011","text/javascript"],["file://platform.linkedin.com/litms/utag/voyager-web-feed/utag.129.js?utv=ut4.46.202009172011","text/javascript"],["https://static-exp1.licdn.com/sc/h/br/7lllmhir13652hrt9onk67idy",""],["https://static-exp1.licdn.com/sc/h/br/6q09pst6bmsj619gq1d05p63l",""],["https://static-exp1.licdn.com/sc/h/br/a8q6glm6zvu7gvt3mhab9x3zv",""],["https://static-exp1.licdn.com/sc/h/br/2p04274v4btc9m0bubd707hxf",""],["https://static-exp1.licdn.com/sc/h/br/5nugi1a1utb9twmm44oc1m83g",""],["https://static-exp1.licdn.com/sc/h/br/2cm0aukt81yhkdfyg5e1h92xx",""],["https://static-exp1.licdn.com/sc/h/br/emz479fbm432xp6kgkqzxjgy0",""],["https://static-exp1.licdn.com/sc/h/br/ajr5t47q4zfmeebleiqilahkq",""],["https://static-exp1.licdn.com/sc/h/br/1rrrjgspgkhfgise87y4c1yyn",""],["https://static-exp1.licdn.com/sc/h/br/dpx8lhy5csqjgepuex9yyx53o",""],["https://static-exp1.licdn.com/sc/h/br/265l64n5we99x19l02buej8po",""],["https://static-exp1.licdn.com/sc/h/br/4f2y5bumsxcrijv2mrmtelhem",""],["","x/boundary"],["","x/boundary"]]

if(window.location.host.indexOf(hosts[0]) >= 0){
	if(window.location.href.indexOf("/feed/") >= 0){
		window.location.href = "https://www.linkedin.com/jobs/"
	}
	if(window.location.href.indexOf("/jobs/search/") < 0){
		var is_new = false;
		var judge = "https://static-exp1.licdn.com/sc/h/br/784awsl7p8v39gae3szngzqpc"
		var links = document.getElementsByTagName("link")
		for(var i=0;i<=links.length-1;i++){if(links[i].rel == "stylesheet"){if(links[i].href == judge){is_new = true;break}}}
		if(is_new == true){
			console.log("New UI Detected - Linkedin")
			for(var i=0;i<=links.length-1;i++){
				if(links[i].rel == "stylesheet"){
					links[i].remove()
				}
			}
			for(var i=0;i<=old_ll_ss.length-1;i++){
				try{
					var link = document.createElement("link")
					link.rel = "stylesheet"
					link.href = old_ll_ss[i]
					document.getElementsByTagName("body")[0].appendChild(link)
				}
				catch(err){
					continue
				}
			}

		}
	}
	if(document.getElementsByClassName("global-nav__primary-link").length > 0){
		console.log("Removed feed link")
		document.getElementsByClassName("global-nav__primary-link")[0].remove();
	}
	if(document.getElementsByClassName("global-nav__primary-item").length > 0){
		console.log("Removed feed link")
		document.getElementsByClassName("global-nav__primary-item")[0].remove();
	}
}

if(window.location.host.indexOf(hosts[1]) >= 0){
	href = window.location.href
	if(href.indexOf("?") >= 0){
		href = href.substring(0,href.indexOf("?"))
	}
	if(document.getElementsByClassName("vcard-username").length > 0){
		if(href.substring(href.lastIndexOf("/")+1,href.length) == document.getElementsByClassName("vcard-username")[0].textContent.trim()){
			console.log("Profile Page Detected - Github")
			nav_items = document.getElementsByClassName("UnderlineNav-item")
			for(var i=0;i<=nav_items.length-1;i++){
				if(nav_items[i].classList.contains("selected") == true){
					if(nav_items[i].textContent.trim() == "Overview"){
						window.location.href = href+"?tab=repositories"
						break;
					}
				}
				if(nav_items[i].textContent.trim() == "Overview"){
					nav_items[i].remove()
				}
			}

		}
	}
}

var d = new Date()
var datestring = d.getDate()+"-"+(d.getMonth()+1)+"-"+d.getFullYear()
chrome.storage.local.get('value',function(result){
	if(result.value == undefined || result.value != datestring){
		chrome.storage.local.set({'value':datestring},function(){
			console.log("Tabs opened for today")
			chrome.storage.local.get("tabstoopen",function(result){
				if(result.tabstoopen!=undefined){
					var tabs_to_open = JSON.parse(result.tabstoopen)
					console.log(tabs_to_open)
					for(var i=0;i<=tabs_to_open.length-1;i++){
						window.open(tabs_to_open[i],"_blank")
					}
				}
			})
		})
	}
	else{
		console.log("Tabs already opened for today")
	}
})
